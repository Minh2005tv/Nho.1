{% extends "master.html" %}

{% block Navbar %}
  {% include 'Navbar.html' %}
{% endblock %}

{% block content %}
  <div class="container text-center">
    <h2>Đang xử lý thanh toán...</h2>
    <p>Vui lòng chờ trong giây lát.</p>
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
  </div> 

  <script>
    document.addEventListener("DOMContentLoaded", function() {
      setTimeout(function() {
        let paymentMethod = localStorage.getItem("paymentMethod");
        let success = Math.random() > 0.2; // 80% thành công
        
        if (paymentMethod === "cash") {
          if (success) {
            alert("Thanh toán bằng tiền mặt thành công!");
            window.location.href = "/payment-success";
          } else {
            alert("Thanh toán bằng tiền mặt thất bại. Vui lòng thử lại!");
            window.location.href = "/payment-failed";
          }
        } else {
          if (success) {
            window.location.href = "/payment-success";
          } else {
            window.location.href = "/payment-failed";
          }
        }
      }, 3000);
    });
  </script>
{% endblock %}
